"use strict";const btnSearch=document.querySelector(".js-btn"),inputSearch=document.querySelector(".js-input"),list=document.querySelector(".js-list"),favList=document.querySelector(".js-favourite");let allCharacters=[],searchList=[],favCharacters=[];function renderAllCharacters(e,t){t.innerHTML="";for(const a of e)renderCharacter(a,t)}function renderCharacter(e,t){const a=document.createElement("li"),r=document.createElement("article"),c=document.createElement("img"),n=document.createElement("h3"),s=document.createElement("h4");a.appendChild(r),r.appendChild(c),r.appendChild(n),r.appendChild(s),c.setAttribute("src",e.img),c.setAttribute("alt",""+e.name);const i=document.createTextNode(e.name),l=document.createTextNode(e.status);n.appendChild(i),s.appendChild(l),r.setAttribute("id",""+e.char_id),r.setAttribute("class","section__list__article"),c.setAttribute("class","section__list__article--img"),t.appendChild(a)}function handleClick(e){e.preventDefault();const t=inputSearch.value;fetch("https://breakingbadapi.com/api/characters?name="+t).then(e=>e.json()).then(e=>{searchList=e,renderAllCharacters(searchList,list),addEvent()})}function addEvent(){const e=document.querySelectorAll(".section__list__article");for(const t of e)t.addEventListener("click",handleFavourites)}function handleFavourites(e){e.preventDefault();const t=e.currentTarget;if(-1===searchInArray(parseInt(t.id)))t.classList.add("favourite"),favCharacters.push(allCharacters.find(e=>e.char_id===parseInt(t.id)));else{t.classList.remove("favourite");const e=searchInArray(parseInt(t.id));favCharacters.splice(e,1)}localStorage.setItem("favChar",JSON.stringify(favCharacters)),renderAllCharacters(favCharacters,favList)}function searchInArray(e){return favCharacters.findIndex(t=>t.char_id===e)}function markFavourites(){for(const e of favCharacters){let t=e.char_id;if(t){document.getElementById(t).classList.add("favourite")}}}fetch("https://breakingbadapi.com/api/characters").then(e=>e.json()).then(e=>{allCharacters=e,renderAllCharacters(allCharacters,list),localStorage.getItem("favChar")&&(favCharacters=JSON.parse(localStorage.getItem("favChar")),renderAllCharacters(favCharacters,favList),markFavourites()),addEvent()}),btnSearch.addEventListener("click",handleClick);